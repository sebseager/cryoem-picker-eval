<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>PARSED - cryo-docs</title> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.6.1 --> <title>PARSED | cryo-docs</title> <meta name="generator" content="Jekyll v3.9.0" /> <meta property="og:title" content="PARSED" /> <meta property="og:locale" content="en_US" /> <link rel="canonical" href="http://localhost:4000/parsed.html" /> <meta property="og:url" content="http://localhost:4000/parsed.html" /> <meta property="og:site_name" content="cryo-docs" /> <script type="application/ld+json"> {"url":"http://localhost:4000/parsed.html","headline":"PARSED","@type":"WebPage","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="http://localhost:4000/" class="site-title lh-tight"> cryo-docs </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="http://localhost:4000/" class="nav-list-link">Home</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/pickers" class="nav-list-link">Particle Pickers</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/aspire-apple.html" class="nav-list-link">ASPIRE APPLEpicker</a></li><li class="nav-list-item "><a href="http://localhost:4000/autocryopicker.html" class="nav-list-link">AutoCryoPicker</a></li><li class="nav-list-item "><a href="http://localhost:4000/deeppicker.html" class="nav-list-link">DeepPicker</a></li><li class="nav-list-item "><a href="http://localhost:4000/relion-log.html" class="nav-list-link">RELION LoG (Laplacian-of-Gaussian) Picker</a></li><li class="nav-list-item "><a href="http://localhost:4000/sphire-cryolo.html" class="nav-list-link">SPHIRE-crYOLO</a></li><li class="nav-list-item "><a href="http://localhost:4000/topaz.html" class="nav-list-link">Topaz</a></li></ul></li><li class="nav-list-item"><a href="http://localhost:4000/empiar.html" class="nav-list-link">EMPIAR</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search cryo-docs" aria-label="Search cryo-docs" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="//github.com/sebseager/cryo-docs" class="site-button" > cryo-docs on GitHub </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="">pickers</a></li> <li class="breadcrumb-nav-list-item"><span>PARSED</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h1 id="parsed"> <a href="#parsed" class="anchor-heading" aria-labelledby="parsed"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> PARSED </h1> <h2 id="summary"> <a href="#summary" class="anchor-heading" aria-labelledby="summary"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Summary </h2> <p>PARSED is available as a collection of Python programs. We used Python 3.6 for this installation.</p> <p>The PARSED paper can be found <a href="https://doi.org/10.1093/bioinformatics/btz728">here</a>. Both the PARSED <a href="/pickers/parsed/original">package files</a> and a <a href="/pickers/parsed/PARSED_Manual_V1.pdf">user manual</a> can be downloaded in the <code class="language-plaintext highlighter-rouge">parsed_v1.zip</code> archive available with the supplementary materials of the PARSED paper. We include all relevant files in <code class="language-plaintext highlighter-rouge">pickers/parsed/</code> of this repo for ease of access. In doing so, we adopt for these files the same usage license identified in the paper, namely:</p> <blockquote> <p>the PARSED package and user manual [are available] for noncommercial use</p> </blockquote> <h2 id="installation"> <a href="#installation" class="anchor-heading" aria-labelledby="installation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Installation </h2> <p>First, make a new directory for the PARSED package.</p> <p>```shell script mkdir parsed</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
PARSED is available as it was originally published in `pickers/parsed/original/`. Modified versions of these files with our patches and bug fixes are available in in `pickers/parsed/`. We will assume the patched files are being used, but the original software can be used at any time by replacing references to `pickers/parsed/` with `pickers/parsed/original` where applicable.

Create and activate a new conda environment with the required dependencies. It may take conda several tries to solve this environment due to the highly specific package dependencies. The versions specified for each package correspond with those listed on the first page of the [PARSED user manual](/pickers/parsed/PARSED_Manual_V1.pdf). It may be possible to use later versions of some packages (e.g., `mrcfile`) without adverse effects.

```shell script
conda create -n parsed -c conda-forge h5py=2.7.1 keras=2.0.8 numba=0.37.0 pandas=0.20.3 matplotlib=2.1.0 mrcfile=1.1.2 trackpy=0.4.1 tensorflow-gpu=1.7.0 pip python=3.6
conda activate parsed
</code></pre></div></div> <p>Install any additional dependencies (not directly available through conda) with <code class="language-plaintext highlighter-rouge">pip</code>. In doing so, however, it is important that we use the <code class="language-plaintext highlighter-rouge">pip</code> executable that was just installed in the conda environment created above. To verify this, check that running <code class="language-plaintext highlighter-rouge">which pip</code> outputs something like <code class="language-plaintext highlighter-rouge">/path/to/conda_envs/parsed/bin/pip</code>. If not, try restarting your shell session or running <code class="language-plaintext highlighter-rouge">conda deactivate parsed</code> followed by <code class="language-plaintext highlighter-rouge">conda activate parsed</code> before proceeding.</p> <p>```shell script pip install opencv-python==3.1.*</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
## Usage

### Overview

Inputs
- micrographs for which to pick particles
- picking aperture size, micrograph pixel resolution, and other configurable parameters
- general model `*.h5` file

Outputs (in a single directory)
- `*.star` coordinate files (for context, `.star` files are text-based file formats for storing data, essentially containing the titles and collections of data in text)
- `*.star` extended parameter files (containing coordinates, but also blob mass and other data)
- `*.h5` data files (not used)

### Pick using pretrained model

Start by collecting the micrograph files (`*.mrc`) to be picked in a directory (assuming they are not already available in their own directory). If you would like to use an existing public data set, [our guide to the EMPIAR database](/empiar.html) may be helpful.

```shell script
mkdir -p name_of_data_set/mrc
mv path/to/your_mrc_files/*.mrc name_of_data_set/mrc
</code></pre></div></div> <p>Here we will use the micrographs located in <code class="language-plaintext highlighter-rouge">demo_data/</code> as an example. Create another directory, in which any output, temporary, or configuration files will be saved by the picker.</p> <p>```shell script mkdir demo_data/parsed_out</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
Use the following command to pick all micrographs in `demo_data/mrc/`. A description of parameters (modified from the [PARSED user manual](/pickers/parsed/PARSED_Manual_V1.pdf)) is given below.

```shell script
python -W ignore parsed_main.py --model=pickers/parsed/pre_train_model.h5 --data_path=demo_data/mrc/ --output_path=demo_data/parsed_out/ --file_pattern=*.mrc --job_suffix=autopick --angpixel=1.34 --img_size=4096 --edge_cut=0  --core_num=4 --aperture=160 --mass_min=4
</code></pre></div></div> <p>When providing arguments for the command above, relative directories can be specified with <code class="language-plaintext highlighter-rouge">./</code> and <code class="language-plaintext highlighter-rouge">../</code>, but do not use <code class="language-plaintext highlighter-rouge">~</code>, <strong>as it does not appear to expand to the user’s home folder</strong>. Note that if PARSED does not recognize a path, it may exit with the usual <code class="language-plaintext highlighter-rouge">No such file or directory</code>, or it may also attempt to pick anyway, returning <code class="language-plaintext highlighter-rouge">Coordinates extraction finished 0 TotalPickNum found</code>.</p> <p>Parameters</p> <ul> <li><code class="language-plaintext highlighter-rouge">--model</code>: pre-trained segmentation model</li> <li><code class="language-plaintext highlighter-rouge">--data_path</code>: path to directory of input micrographs</li> <li><code class="language-plaintext highlighter-rouge">--output_path</code>: path to output directory</li> <li><code class="language-plaintext highlighter-rouge">--file_pattern</code>: regex (regular expression)-like pattern that describes the filenames of the micrographs to be picked (e.g., <code class="language-plaintext highlighter-rouge">*.mrc</code> includes only files ending in <code class="language-plaintext highlighter-rouge">.mrc</code>)</li> <li><code class="language-plaintext highlighter-rouge">--job_suffix</code>: suffix to be appended to the filenames of the output coordinate files (e.g., the input micrograph <code class="language-plaintext highlighter-rouge">Falcon_2012_06_12-15_27_22_0.mrc</code> would correspond with an output coordinate file named <code class="language-plaintext highlighter-rouge">Falcon_2012_06_12-15_27_22_0_autopick.star</code>)</li> <li><code class="language-plaintext highlighter-rouge">--angpixel</code>: sample rate (pixel resolution) for specified micrographs (in Å/pixel)</li> <li><code class="language-plaintext highlighter-rouge">--img_size</code>: either the width or height of the micrograph in pixels—whichever is larger</li> <li><code class="language-plaintext highlighter-rouge">--edge_cut</code>: number of pixels to “crop” from each edge of the micrograph</li> <li><code class="language-plaintext highlighter-rouge">--core_num</code>: number of processes to run in parallel</li> <li><code class="language-plaintext highlighter-rouge">--aperture</code>: diameter of the particle-picking aperture (in Å)</li> <li><code class="language-plaintext highlighter-rouge">--mass_min</code>: minimal picking mass of detected blobs (particle candidates)</li> </ul> <p>Note: a GPU ID to use for picking can also be specified by appending the <code class="language-plaintext highlighter-rouge">--gpu_id #</code> flag, where <code class="language-plaintext highlighter-rouge">#</code> is the GPU ID. On an NVIDIA-based system, use the <code class="language-plaintext highlighter-rouge">nvidia-smi</code> command to get a list of available GPUs and their IDs.</p> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
